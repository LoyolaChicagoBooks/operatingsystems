<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" metia="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Implementing Files and Folders | Operating Systems: updated 18 May 2023</title>
<meta content="Implementing Files and Folders | Operating Systems: updated 18 May 2023" property="og:title"/>
<meta content="Implementing Files and Folders | Operating Systems: updated 18 May 2023" name="twitter:title"/>
<link href="_static/pygments.css" rel="stylesheet"/>
<link href="_static/theme.a16405b310edf0713aee.css" rel="stylesheet"/>
<link href="search.html" rel="search" title="Search"/>
<link href="genindex.html" rel="index" title="Index"/>
<link href="research.html" rel="next" title="Storage Research at Loyola"/>
<link href="storage.html" rel="prev" title="Storage and Devices"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/sphinx_highlight.js"></script>
<script defer="" src="_static/theme.ad172c0f1249198ea036.js"></script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="index.html"><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">Operating Systems: updated 18 May 2023</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none">
<form @keydown.k.window.meta="$refs.search.focus()" action="search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
      K
    </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="index.html"><span class="font-bold text-clip whitespace-nowrap">Operating Systems: updated 18 May 2023</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="meta.html">About the Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="processes.html">Introduction to Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="files-io.html">Files and I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduling.html">Process/Thread Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutualexclusion.html">Mutual Exclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="deadlock.html">Deadlock</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipc.html">IPC Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernelmm.html">Virtual Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="userlandmm.html">Userland Memory Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="storage.html">Storage and Devices</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implementing Files and Folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="research.html">Storage Research at Loyola</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_vm.html">Installing a Linux Virtual Machine with VMware</a></li>
<li class="toctree-l1"><a class="reference internal" href="windows_vm.html">Installing a Windows Virtual Machine with VMware</a></li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="index.html">
<span class="hidden md:inline">Operating Systems: updated 18 May 2023</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">/</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">Implementing Files and Folders</span>
</nav>
<div id="content" role="main">
<section id="implementing-files-and-folders">
<h1>Implementing Files and Folders<a class="headerlink" href="#implementing-files-and-folders" title="Permalink to this heading">¶</a></h1>
<section id="id1">
<h2>Implementing Files and Folders<a class="headerlink" href="#id1" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id1'">¶</a></h2>
<ul class="simple">
<li><p>How files and folders are implemented in a storage medium can greatly
depend upon the physical characteristics and capabilities of that
medium.</p></li>
<li><p>For example, on tape-drives, CD/DVD/Blu-Ray, or write-once media,
files and folders are stored contiguously with no fragmentation. All
of the information about the filesystem can be held in a TOC (Table
Of Contents).</p></li>
<li><p>For filesystems with files that have a finite lifetime, such as on
flash media, hard disks, SSDs, and others, the layout of files and
folders must be maintained in a more complex way.</p></li>
<li><p>Among these more advanced methods are linked lists and i-nodes.</p></li>
<li><p>To manage free-space, objects like bit-maps and linked lists are
possibilities.</p></li>
</ul>
</section>
<section id="linked-lists">
<h2>Linked-Lists<a class="headerlink" href="#linked-lists" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#linked-lists'">¶</a></h2>
<blockquote>
<div><figure class="align-center" id="id22">
<img alt="image" src="_images/linked_list_files.png"/>
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id22" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="id2">
<h2>Linked-Lists<a class="headerlink" href="#id2" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id2'">¶</a></h2>
<ul class="simple">
<li><p>Pros:</p>
<ul>
<li><p>No external fragmentation of files.</p></li>
<li><p>Simple to implement</p></li>
<li><p>Sequential access is very simple.</p></li>
</ul>
</li>
<li><p>Cons:</p>
<ul>
<li><p>Has internal fragmentation of the last block unless the last block
is used completely.</p></li>
<li><p>Random access in the file is difficult because for N blocks K-1
blocks must be read to find block K.</p></li>
<li><p>Storage available in a single block is not a power of two. Most
programs send data to the filesystem in as buffers of sizes that
are powers of two.</p></li>
</ul>
</li>
</ul>
</section>
<section id="file-allocation-tables-fat">
<h2>File Allocation Tables (FAT)<a class="headerlink" href="#file-allocation-tables-fat" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#file-allocation-tables-fat'">¶</a></h2>
<blockquote>
<div><figure class="align-center" id="id23">
<img alt="image" src="_images/linked_list_files_table.png"/>
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id23" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="id3">
<h2>File Allocation Tables (FAT)<a class="headerlink" href="#id3" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id3'">¶</a></h2>
<ul class="simple">
<li><p>FAT based filesystems improve over linked list filesystems by moving
the linked list into a centralized table called the FAT.</p></li>
<li><p>At FS mount time, the FAT is loaded into main memory. Random access
is fast even though traversal is still needed.</p></li>
<li><p>Pros:</p>
<ul>
<li><p>Implementing a FAT FS is simple. Managing free space and disk
layout is simple.</p></li>
<li><p>FAT can be loaded into memory for fast and simple operations.</p></li>
<li><p>Because blocks don’t contain pointers, the entire block can be
used for data.</p></li>
</ul>
</li>
<li><p>Cons:</p>
<ul>
<li><p>For large filesystems the FAT can become large and consume a lot
of memory.</p></li>
</ul>
</li>
</ul>
</section>
<section id="inodes">
<h2>inodes<a class="headerlink" href="#inodes" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#inodes'">¶</a></h2>
<ul class="simple">
<li><p>inodes are the fundamental structures of a UNIX filesystem</p></li>
<li><p>inodes have the following attributes:</p>
<ul>
<li><p>File Ownership - user, group</p></li>
<li><p>File Mode - rwx bits for each of user, group, and others</p></li>
<li><p>Last access and modified timestamps</p></li>
<li><p>File size in bytes</p></li>
<li><p>Device id</p></li>
<li><p>Pointers to blocks on the storage device for the file or folder’s
contents</p></li>
</ul>
</li>
</ul>
</section>
<section id="minix-inode">
<h2>Minix - inode<a class="headerlink" href="#minix-inode" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#minix-inode'">¶</a></h2>
<blockquote>
<div><figure class="align-center" id="id24">
<img alt="image" src="_images/minix_inode.png"/>
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id24" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="id4">
<h2>Minix - inode<a class="headerlink" href="#id4" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id4'">¶</a></h2>
<ul class="simple">
<li><p>The first 7 “zones” point to the first 7 blocks of the file.</p></li>
<li><p>The “indirect zone” points to another block that contains a list of
additional zones.</p></li>
<li><p>This has the advantage that the file can begin to be read quickly
with the initial set of blocks available.</p></li>
<li><p>Also, the indirect zone allows for relatively fast random access by
traversing the indirect blocks like a tree.</p></li>
<li><p>The pointer to a “double indirect” zone is a list of a list of zones.</p></li>
<li><p>The first few zones can address 7KB. The indirect zones can address
up to 64MB. The double indirect zones can address more than 4GB.</p></li>
</ul>
</section>
<section id="id5">
<h2>inodes<a class="headerlink" href="#id5" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id5'">¶</a></h2>
<ul class="simple">
<li><p>The strategy of using indirect, double indirect, and even triple
indirect blocks is a very successful implementation strategy</p></li>
<li><p>This approach is also used by ext2 / ext3 / ext4 in Linux.</p></li>
</ul>
</section>
<section id="block-caches">
<h2>Block Caches<a class="headerlink" href="#block-caches" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#block-caches'">¶</a></h2>
<ul class="simple">
<li><p>To improve the performance of a filesystem, and to make disk
scheduling algorithms more realizable, most operating systems
implement some kind of block cache.</p></li>
<li><p>The block cache allows for read-ahead and write-behind. It also
allows for lower latency I/O operations.</p></li>
<li><p>With a block cache, the write() system call for instance only needs
to complete modifications to the cache before returning. The
operating system can complete the operation on disk in a background
thread.</p></li>
<li><p>Without this cache, the system call would not be able to return until
the write had been committed to disk.</p></li>
</ul>
</section>
<section id="id6">
<h2>Block Caches<a class="headerlink" href="#id6" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id6'">¶</a></h2>
<ul>
<li><p>In Minix, the block cache is implemented with an LRU policy. The
cache maintains a linked list of buffers from most recently to least
recently used</p>
<blockquote>
<div><figure class="align-center" id="id25">
<img alt="image" src="_images/minix_block_cache.png"/>
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id25" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
</li>
</ul>
</section>
<section id="id7">
<h2>Block Caches<a class="headerlink" href="#id7" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id7'">¶</a></h2>
<ul class="simple">
<li><p>Important parameters of any block cache are:</p>
<ul>
<li><p>The size of the cache in physical memory</p></li>
<li><p>The delay before committing ’dirty’ items in the cache to disk</p></li>
</ul>
</li>
<li><p>The larger the cache, the better the filesystem will likely perform,
but this can come at the cost of available memory for programs.</p></li>
<li><p>The larger the delay before writing items to the disk, the better the
disk allocation and scheduling decisions the operating system can
make.</p></li>
<li><p>The shorter the delay before writing to disk, the greater the
guarantee in the presence of failure that modifications will be
persisted to disk.</p></li>
</ul>
</section>
<section id="folders-and-path-traversal">
<h2>Folders and Path Traversal<a class="headerlink" href="#folders-and-path-traversal" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#folders-and-path-traversal'">¶</a></h2>
<ul class="simple">
<li><p>In all but the most simple filesystems, there is a concept of a
folder and a path.</p></li>
<li><p>In UNIX operating systems, folder entries are held within inodes that
have the filetype in the mode set to type directory.</p></li>
<li><p>The contents of the inode then are a list of filenames and pointers
to the inodes of those files and/or folders.</p></li>
<li><p>Resolving paths involve accessing a root folder, and accessing each
folder recursively until reaching a file or finding the folder to be
invalid.</p></li>
</ul>
</section>
<section id="path-traversal">
<h2>Path Traversal<a class="headerlink" href="#path-traversal" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#path-traversal'">¶</a></h2>
<ul>
<li><p>An example of path traversal. When traversing paths, the path may
cross into different filesystems.</p>
<blockquote>
<div><figure class="align-center" id="id26">
<img alt="image" src="_images/path_traversal.png"/>
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</div></blockquote>
</li>
</ul>
</section>
<section id="virtual-filesystems-vfs">
<h2>Virtual Filesystems / VFS<a class="headerlink" href="#virtual-filesystems-vfs" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#virtual-filesystems-vfs'">¶</a></h2>
<ul class="simple">
<li><p>Aside from files and folders there are other things like named pipes,
domain sockets, symbolic and hard links that need to be handled by
the filesystem.</p></li>
<li><p>Rather than have the semantics of these implemented in each
filesystem implementation, many OS architectures include a virtual
filesystem or VFS.</p></li>
<li><p>The VFS stands between the OS kernel and the filesystem
implementation.</p></li>
</ul>
</section>
<section id="id8">
<h2>Virtual Filesystems / VFS<a class="headerlink" href="#id8" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id8'">¶</a></h2>
<ul class="simple">
<li><p>The VFS can help adapt both foreign filesystems (such as VFAT) by
producing a contract that these implementations can adapt to.</p></li>
<li><p>The VFS can also help reduce code duplication between FS
implementations by providing common structures and handling shared
behavior:</p>
<ul>
<li><p>Path traversal</p></li>
<li><p>Handling named pipes, domain sockets, etc…</p></li>
<li><p>Managing file handles and file locking</p></li>
<li><p>Structures and functions for the block cache.</p></li>
<li><p>Structures and functions for accessing storage devices</p></li>
</ul>
</li>
</ul>
</section>
<section id="virtual-filesystems-and-stacking">
<h2>Virtual Filesystems and Stacking<a class="headerlink" href="#virtual-filesystems-and-stacking" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#virtual-filesystems-and-stacking'">¶</a></h2>
<ul class="simple">
<li><p>In some VFS implementations it is possible to stack filesystems on
top of each other.</p></li>
<li><p>A great example of this in Linux is UMSDOS: the base VFAT filesystem
does not have support for users, groups, security or extended
attributes. By creating special files on VFAT and then hiding them,
UMSDOS can adapt VFAT to be a UNIX-like filesystem</p></li>
<li><p>Another great example of this is UnionFS. It allows two filesystems
to be transparently overlaid.</p></li>
</ul>
</section>
<section id="virtual-filesystems-and-user-mode">
<h2>Virtual Filesystems and User-Mode<a class="headerlink" href="#virtual-filesystems-and-user-mode" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#virtual-filesystems-and-user-mode'">¶</a></h2>
<ul class="simple">
<li><p>Because VFS provides a contract for a filesystem to implement, it is
simpler for unique filesystems to be implemented. Good examples
include:</p></li>
<li><p>Proc - process and kernel metadata, typically mounted under ’/proc’</p></li>
<li><p>SysFs - exposes block and character device files to user mode,
typically mounted under ’/dev’</p></li>
<li><p>FUSE - provides infrastructure to redirect calls to and from the VFS
to and from user mode programs.</p></li>
</ul>
</section>
<section id="user-mode-filesystems">
<h2>User-Mode Filesystems<a class="headerlink" href="#user-mode-filesystems" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#user-mode-filesystems'">¶</a></h2>
<ul class="simple">
<li><p>The advent of user-mode filesystems in popular operating systems
(they existed in less popular operating systems for a while) has led
to a great deal of new filesystem development.</p></li>
<li><p>The two most popular systems are FUSE for Linux / MacOSX, and other
UNIX-like systems, and Dokan for Windows systems.</p></li>
<li><p>These frameworks have been greatly successful in large part because
they help make the task of systems development much easier.</p></li>
</ul>
</section>
<section id="id9">
<h2>User-Mode Filesystems<a class="headerlink" href="#id9" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id9'">¶</a></h2>
<ul class="simple">
<li><p>Development in a monolithic kernel can be very challenging. Crashes
can bring the entire system down, stopping and restarting components
may not be possible, and often debugging is limited to logs.</p></li>
<li><p>With user-mode development, it is possible to make use of a debugger
in most cases.</p></li>
<li><p>Because of these advantages systems like FUSE and Dokan have become
very popular.</p></li>
<li><p>Other areas of systems that were traditionally kernel mode only have
moved to user-mode systems to ease development and improve
architecture. In Windows, the display manager, and much of the driver
framework has moved to user-mode.</p></li>
</ul>
</section>
<section id="example-pass-through-fuse-filesystem">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#example-pass-through-fuse-filesystem" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#example-pass-through-fuse-filesystem'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">AbsPath</span><span class="p">(</span>
    <span class="n">char</span> <span class="n">dest</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">],</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">strcpy</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">_root</span><span class="p">);</span>
  <span class="n">strncat</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">PATH_MAX</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">void</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">setRootDir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"setting FS root to: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">_root</span> <span class="o">=</span> <span class="n">path</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Getattr</span><span class="p">(</span>
    <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">struct</span> <span class="n">stat</span> <span class="o">*</span><span class="n">statbuf</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"getattr(</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">fullPath</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">lstat</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">statbuf</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id10">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id10" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id10'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Readlink</span><span class="p">(</span>
<span class="n">const</span> <span class="n">char</span><span class="o">*</span> <span class="n">path</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">link</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">){</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"readlink(path=</span><span class="si">%s</span><span class="s2">, link=</span><span class="si">%s</span><span class="s2">, size=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
                          <span class="n">path</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">size</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">readlink</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">size</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Mknod</span><span class="p">(</span>
<span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">mode_t</span> <span class="n">mode</span><span class="p">,</span> <span class="n">dev_t</span> <span class="n">dev</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"mknod(path=</span><span class="si">%s</span><span class="s2">, mode=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="o">//</span><span class="n">handles</span> <span class="n">creating</span> <span class="n">FIFOs</span><span class="p">,</span> <span class="n">regular</span> <span class="n">files</span><span class="p">,</span> <span class="n">etc</span><span class="o">...</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">mknod</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">dev</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id11">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id11" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id11'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Mkdir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">mode_t</span> <span class="n">mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"**mkdir(path=</span><span class="si">%s</span><span class="s2">, mode=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">mode</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">mkdir</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">mode</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Unlink</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"unlink(path=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">)"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">unlink</span><span class="p">(</span><span class="n">fullPath</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Rmdir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"rmkdir(path=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">)"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">rmdir</span><span class="p">(</span><span class="n">fullPath</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id12">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id12" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id12'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Symlink</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">link</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"symlink(path=</span><span class="si">%s</span><span class="s2">, link=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">link</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">symlink</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">link</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Rename</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">newpath</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"rename(path=</span><span class="si">%s</span><span class="s2">, newPath=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">newpath</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">rename</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">newpath</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id13">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id13" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id13'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Link</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">newpath</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"link(path=</span><span class="si">%s</span><span class="s2">, newPath=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">newpath</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">char</span> <span class="n">fullNewPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullNewPath</span><span class="p">,</span> <span class="n">newpath</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">link</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">fullNewPath</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Chmod</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">mode_t</span> <span class="n">mode</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"chmod(path=</span><span class="si">%s</span><span class="s2">, mode=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">chmod</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">mode</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id14">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id14" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id14'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Chown</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">uid_t</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid_t</span> <span class="n">gid</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"chown(path=</span><span class="si">%s</span><span class="s2">, uid=</span><span class="si">%d</span><span class="s2">, gid=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">uid</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">gid</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">chown</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Truncate</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">off_t</span> <span class="n">newSize</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"truncate(path=</span><span class="si">%s</span><span class="s2">, newSize=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">newSize</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">truncate</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">newSize</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Utime</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">struct</span> <span class="n">utimbuf</span> <span class="o">*</span><span class="n">ubuf</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"utime(path=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">utime</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">ubuf</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id15">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id15" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id15'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Open</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span>
        <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Read</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="n">off_t</span> <span class="n">offset</span><span class="p">,</span> <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">pread</span><span class="p">(</span><span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Write</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="n">off_t</span> <span class="n">offset</span><span class="p">,</span> <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">pwrite</span><span class="p">(</span><span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">offset</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id16">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id16" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id16'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Statfs</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">struct</span> <span class="n">statvfs</span> <span class="o">*</span><span class="n">statInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"statfs(path=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">statvfs</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">statInfo</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Flush</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"flush(path=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="o">//</span><span class="n">noop</span> <span class="n">because</span> <span class="n">we</span> <span class="n">don</span><span class="s1">'t maintain our own buffers</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Release</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"release(path=</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id17">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id17" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id17'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Fsync</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="nb">int</span> <span class="n">datasync</span><span class="p">,</span> <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fi</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"fsync(path=</span><span class="si">%s</span><span class="s2">, datasync=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">datasync</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">datasync</span><span class="p">)</span> <span class="p">{</span>
    <span class="o">//</span><span class="n">sync</span> <span class="n">data</span> <span class="n">only</span>
    <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">fdatasync</span><span class="p">(</span><span class="n">fi</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="o">//</span><span class="n">sync</span> <span class="n">data</span> <span class="o">+</span> <span class="n">file</span> <span class="n">metadata</span>
    <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">fsync</span><span class="p">(</span><span class="n">fi</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Setxattr</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="nb">int</span> <span class="n">flags</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"setxattr(path=</span><span class="si">%s</span><span class="s2">, name=</span><span class="si">%s</span><span class="s2">, value=</span><span class="si">%s</span><span class="s2">, size=</span><span class="si">%d</span><span class="s2">, flags=</span><span class="si">%d</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
    <span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">size</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">lsetxattr</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">flags</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id18">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id18" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id18'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Getxattr</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span>
    <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">char</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">getxattr</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Listxattr</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span>
    <span class="n">char</span> <span class="o">*</span><span class="nb">list</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">llistxattr</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">size</span><span class="p">));</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Removexattr</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">lremovexattr</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">name</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id19">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id19" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id19'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>int ExampleFS::Opendir(const char *path,
    struct fuse_file_info *fileInfo) {
  printf("opendir(path=%s)\n", path);
  char fullPath[PATH_MAX];
  AbsPath(fullPath, path);
  DIR *dir = opendir(fullPath);
  fileInfo-&gt;fh = (uint64_t)dir;
  return NULL -- dir ? -errno : 0;
}
</pre></div>
</div>
</section>
<section id="id20">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id20" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id20'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Readdir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
    <span class="n">fuse_fill_dir_t</span> <span class="n">filler</span><span class="p">,</span> <span class="n">off_t</span> <span class="n">offset</span><span class="p">,</span>
    <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="s2">"readdir(path=</span><span class="si">%s</span><span class="s2">, offset=</span><span class="si">%d</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="n">offset</span><span class="p">);</span>
  <span class="n">DIR</span> <span class="o">*</span><span class="nb">dir</span> <span class="o">=</span> <span class="p">(</span><span class="n">DIR</span><span class="o">*</span><span class="p">)</span><span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">;</span>
  <span class="n">struct</span> <span class="n">dirent</span> <span class="o">*</span><span class="n">de</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="n">NULL</span> <span class="o">--</span> <span class="n">de</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">errno</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">do</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="n">filler</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">de</span><span class="o">-&gt;</span><span class="n">d_name</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">while</span><span class="p">(</span><span class="n">NULL</span> <span class="o">!=</span> <span class="p">(</span><span class="n">de</span> <span class="o">=</span> <span class="n">readdir</span><span class="p">(</span><span class="nb">dir</span><span class="p">)));</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id21">
<h2>Example pass-through FUSE Filesystem<a class="headerlink" href="#id21" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#id21'">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Releasedir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span>
    <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">closedir</span><span class="p">((</span><span class="n">DIR</span><span class="o">*</span><span class="p">)</span><span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Fsyncdir</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="nb">int</span> <span class="n">datasync</span><span class="p">,</span>
    <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Init</span><span class="p">(</span><span class="n">struct</span> <span class="n">fuse_conn_info</span> <span class="o">*</span><span class="n">conn</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nb">int</span> <span class="n">ExampleFS</span><span class="p">::</span><span class="n">Truncate</span><span class="p">(</span><span class="n">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="n">off_t</span> <span class="n">offset</span><span class="p">,</span>
    <span class="n">struct</span> <span class="n">fuse_file_info</span> <span class="o">*</span><span class="n">fileInfo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">char</span> <span class="n">fullPath</span><span class="p">[</span><span class="n">PATH_MAX</span><span class="p">];</span>
  <span class="n">AbsPath</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">path</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">RETURN_ERRNO</span><span class="p">(</span><span class="n">ftruncate</span><span class="p">(</span><span class="n">fileInfo</span><span class="o">-&gt;</span><span class="n">fh</span><span class="p">,</span> <span class="n">offset</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="fuse">
<h2>FUSE<a class="headerlink" href="#fuse" title="Permalink to this heading" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#fuse'">¶</a></h2>
<ul class="simple">
<li><p>As you can see in the above example, the FUSE filesystem matches
closely the contract of the UNIX system calls for files and folders.</p></li>
<li><p>Each of these functions has very well explained behavior that can be
found in the manual pages for each of them.</p></li>
<li><p>Typically, a FUSE filesystem can be implemented with between 500 -
4000 lines of code. This is fairly comparable to kernel mode
filesystems.</p></li>
<li><p>A very advanced filesystem, NTFS, has been implemented with FUSE in
about 17,500 lines of code.</p></li>
<li><p>A very popular FUSE filesystem, SSHFS, has been implemented in about
4,500 lines of code.</p></li>
<li><p>In the Linux kernel, Ext4 is approximately 35,500 lines of code and
Ext2 is approximately 9000 lines of code.</p></li>
</ul>
</section>
</section>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(var(--vh)-4rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#id1'" class="reference internal" href="#id1">Implementing Files and Folders</a></li>
<li><a :data-current="activeSection === '#linked-lists'" class="reference internal" href="#linked-lists">Linked-Lists</a></li>
<li><a :data-current="activeSection === '#id2'" class="reference internal" href="#id2">Linked-Lists</a></li>
<li><a :data-current="activeSection === '#file-allocation-tables-fat'" class="reference internal" href="#file-allocation-tables-fat">File Allocation Tables (FAT)</a></li>
<li><a :data-current="activeSection === '#id3'" class="reference internal" href="#id3">File Allocation Tables (FAT)</a></li>
<li><a :data-current="activeSection === '#inodes'" class="reference internal" href="#inodes">inodes</a></li>
<li><a :data-current="activeSection === '#minix-inode'" class="reference internal" href="#minix-inode">Minix - inode</a></li>
<li><a :data-current="activeSection === '#id4'" class="reference internal" href="#id4">Minix - inode</a></li>
<li><a :data-current="activeSection === '#id5'" class="reference internal" href="#id5">inodes</a></li>
<li><a :data-current="activeSection === '#block-caches'" class="reference internal" href="#block-caches">Block Caches</a></li>
<li><a :data-current="activeSection === '#id6'" class="reference internal" href="#id6">Block Caches</a></li>
<li><a :data-current="activeSection === '#id7'" class="reference internal" href="#id7">Block Caches</a></li>
<li><a :data-current="activeSection === '#folders-and-path-traversal'" class="reference internal" href="#folders-and-path-traversal">Folders and Path Traversal</a></li>
<li><a :data-current="activeSection === '#path-traversal'" class="reference internal" href="#path-traversal">Path Traversal</a></li>
<li><a :data-current="activeSection === '#virtual-filesystems-vfs'" class="reference internal" href="#virtual-filesystems-vfs">Virtual Filesystems / VFS</a></li>
<li><a :data-current="activeSection === '#id8'" class="reference internal" href="#id8">Virtual Filesystems / VFS</a></li>
<li><a :data-current="activeSection === '#virtual-filesystems-and-stacking'" class="reference internal" href="#virtual-filesystems-and-stacking">Virtual Filesystems and Stacking</a></li>
<li><a :data-current="activeSection === '#virtual-filesystems-and-user-mode'" class="reference internal" href="#virtual-filesystems-and-user-mode">Virtual Filesystems and User-Mode</a></li>
<li><a :data-current="activeSection === '#user-mode-filesystems'" class="reference internal" href="#user-mode-filesystems">User-Mode Filesystems</a></li>
<li><a :data-current="activeSection === '#id9'" class="reference internal" href="#id9">User-Mode Filesystems</a></li>
<li><a :data-current="activeSection === '#example-pass-through-fuse-filesystem'" class="reference internal" href="#example-pass-through-fuse-filesystem">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id10'" class="reference internal" href="#id10">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id11'" class="reference internal" href="#id11">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id12'" class="reference internal" href="#id12">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id13'" class="reference internal" href="#id13">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id14'" class="reference internal" href="#id14">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id15'" class="reference internal" href="#id15">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id16'" class="reference internal" href="#id16">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id17'" class="reference internal" href="#id17">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id18'" class="reference internal" href="#id18">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id19'" class="reference internal" href="#id19">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id20'" class="reference internal" href="#id20">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#id21'" class="reference internal" href="#id21">Example pass-through FUSE Filesystem</a></li>
<li><a :data-current="activeSection === '#fuse'" class="reference internal" href="#fuse">FUSE</a></li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 2013-2020, Operating Systems Faculty at Loyola University Chicago Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 6.2.1</a></p>
</div>
</div>
</footer>
</div>
</body>
</html>