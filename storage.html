<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Storage and Devices &mdash; Operating Systems Updated 2021-09-25 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Implementing Files and Folders" href="fs.html" />
    <link rel="prev" title="Userland Memory Management" href="userlandmm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Operating Systems
          </a>
              <div class="version">
                Updated 2021-09-25
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="meta.html">About the Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="processes.html">Introduction to Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="files-io.html">Files and I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduling.html">Process/Thread Scheduling</a></li>
<li class="toctree-l1"><a class="reference internal" href="mutualexclusion.html">Mutual Exclusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="deadlock.html">Deadlock</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipc.html">IPC Topics</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernelmm.html">Virtual Memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="userlandmm.html">Userland Memory Management</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Storage and Devices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#storage-devices">Storage Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ide-ata">IDE/ATA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#atapi">ATAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sata-serial-ata">SATA - Serial ATA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hard-disk-geometry-chs">Hard Disk Geometry - CHS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Hard Disk Geometry - CHS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hard-disk-geometry-lba">Hard Disk Geometry - LBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#storage-and-failure">Storage and Failure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maximizing-availability-raid">Maximizing Availability - RAID</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid">RAID</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid-0">RAID - 0</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid-1">RAID - 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid-5">RAID - 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid-5-parity">RAID - 5 Parity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">RAID - 5 Parity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">RAID - 5 Parity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">RAID - 5 Parity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raid-5-parity-and-recovery">RAID 5 - Parity and Recovery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disk-partitioning">Disk Partitioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Disk Partitioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disk-arms-heads">Disk Arms / Heads</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id6">Hard Disk Geometry - CHS</a></li>
<li class="toctree-l2"><a class="reference internal" href="#characteristics-of-a-good-disk-scheduling-algorithm">Characteristics of a Good Disk Scheduling Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disk-scheduling-algorithms">Disk Scheduling Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fifo">FIFO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#shortest-seek-first">Shortest Seek First</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">Shortest Seek First</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elevator-algorithm">Elevator Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">Elevator Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#evaluation-of-the-elevator-algorithm">Evaluation of the Elevator Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fscan">FSCAN</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fs.html">Implementing Files and Folders</a></li>
<li class="toctree-l1"><a class="reference internal" href="research.html">Storage Research at Loyola</a></li>
<li class="toctree-l1"><a class="reference internal" href="linux_vm.html">Installing a Linux Virtual Machine with VMware</a></li>
<li class="toctree-l1"><a class="reference internal" href="windows_vm.html">Installing a Windows Virtual Machine with VMware</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Operating Systems</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Storage and Devices</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/storage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="storage-and-devices">
<h1>Storage and Devices<a class="headerlink" href="#storage-and-devices" title="Permalink to this headline"></a></h1>
<section id="storage-devices">
<h2>Storage Devices<a class="headerlink" href="#storage-devices" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Types of permanent devices:</p>
<ul>
<li><p>Magnetic - hard disk, tape, floppy disk</p></li>
<li><p>Optical - CD/DVD/Blu-Ray, Laser Disc, Paper, Punch Cards, Photo
Film</p></li>
<li><p>Solid State - CMOS, NAND based flash, battery backed dynamic
memory</p></li>
</ul>
</li>
<li><p>Types of transient devices:</p>
<ul>
<li><p>RAM, Processor Caches</p></li>
</ul>
</li>
</ul>
</section>
<section id="ide-ata">
<h2>IDE/ATA<a class="headerlink" href="#ide-ata" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Created by Western Digital Corp in 1986. Reused an existing disk
interface.</p></li>
<li><p>Improved greatly over older interfaces due to moving the
responsibility of managing the disk arm to the hard disk itself. This
allowed for a greater variation in disk and motor types regardless of
motherboard support.</p></li>
<li><p>Connector uses 40 pins.</p></li>
<li><p>Data bus width is 16 bits.</p></li>
<li><p>Transfer rates are 16, 33, 66, 100, and 133 MB/s</p></li>
<li><p>Presents to the computer a set of 512-byte blocks.</p></li>
</ul>
</section>
<section id="atapi">
<h2>ATAPI<a class="headerlink" href="#atapi" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Improved upon ATA by adding extra commands (such as ’eject’) to
support other devices.</p></li>
<li><p>These improvements allowed CD, DVD, and Zip drives to conform to ATA</p></li>
<li><p>Also helped improve performance by introducing DMA. DMA allowed for
data transfers to be sent directly to physical memory without
interrupting the CPU for every bus operation</p></li>
</ul>
</section>
<section id="sata-serial-ata">
<h2>SATA - Serial ATA<a class="headerlink" href="#sata-serial-ata" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Helped to reduce cost by reducing the number of pins.</p></li>
<li><p>Allows hot-swapping or replacing of devices without powering down the
main board.</p></li>
<li><p>Supports the full ATAPI command interface</p></li>
<li><p>Supports transfer rates of 1.5G/s (1.0), 3G/S (2.0), and 6G/s (3.0)</p></li>
<li><p>The main board hosting SATA typically implement an AHCI controller
(created by Intel). It supports hotplug capabilities and native
command queuing. Main boards that do not implement AHCI will
typically communicate with the SATA device using the ATAPI command
set.</p></li>
<li><p>SATA is best supported in Linux 2.6.20 or newer, Windows Vista or 7,
and more recent versions of OSX. Older operating systems will often
revert to ATAPI even with an AHCI controller</p></li>
</ul>
</section>
<section id="hard-disk-geometry-chs">
<h2>Hard Disk Geometry - CHS<a class="headerlink" href="#hard-disk-geometry-chs" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Composed of Cylinders, Heads, and Sectors</p></li>
<li><p>Sector - The unit of storage on a disc. Typically 512, 1024, or 2048
bytes.</p></li>
<li><p>Cylinder - A physical, circular disc. Aka “platter”. One or more may
be present in a device.</p></li>
<li><p>Heads - Refers to either the top or bottom sides of a Cylinder.</p></li>
<li><p>The CHS address on a disk is a tuple of the {Cylinder, Head, Sector}</p></li>
</ul>
</section>
<section id="id1">
<h2>Hard Disk Geometry - CHS<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id9">
<img alt="image" src="_images/disk_diagram.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id9" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="hard-disk-geometry-lba">
<h2>Hard Disk Geometry - LBA<a class="headerlink" href="#hard-disk-geometry-lba" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>A CHS tuple can be converted to an LBA address with the following
formula: <span class="math notranslate nohighlight">\($A = (C x Nh + H) * Ns + (S - 1)$\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\($Nh$\)</span> is the total number of heads</p></li>
<li><p><span class="math notranslate nohighlight">\($Ns$\)</span> is the total number of sectors</p></li>
</ul>
</section>
<section id="storage-and-failure">
<h2>Storage and Failure<a class="headerlink" href="#storage-and-failure" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>An excellent paper about hard disk failure rates at Google is
available here:</p></li>
<li><p><a class="reference external" href="http://labs.google.com/papers/disk_failures.pdf">http://labs.google.com/papers/disk_failures.pdf</a></p></li>
<li><p>At Google, the failure rates of disks of a given age are:</p>
<ul>
<li><p>3-months - 2.5</p></li>
<li><p>6-months - 2.0</p></li>
<li><p>1-year - 2</p></li>
<li><p>2-year - 8</p></li>
<li><p>3-year - 8.5</p></li>
</ul>
</li>
</ul>
</section>
<section id="maximizing-availability-raid">
<h2>Maximizing Availability - RAID<a class="headerlink" href="#maximizing-availability-raid" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>To prevent the loss of availability of data, the use of RAID
(Redundant Array of Inexpensive Disks) allows for redundant copies of
data to be stored.</p></li>
<li><p>Common RAID levels are:</p>
<ul>
<li><p>RAID 0 - splits data across disks. Increases disk space and
provides no redundancy. 2 or more disks are needed.</p></li>
<li><p>RAID 1 - creates an exact copy of data on two or more disks.</p></li>
<li><p>RAID 5/6 - splits data across disks. Uses one or more disks for
parity. This allows 1-K out of N disks to fail and allow the data
of any lost disk to be recovered. 3 or more disks are needed.</p></li>
</ul>
</li>
</ul>
</section>
<section id="raid">
<h2>RAID<a class="headerlink" href="#raid" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>RAID has three common implementation approaches:</p>
<ul>
<li><p>Complete hardware implementation - a disk controller or expansion
card implements RAID. Several disks are connected to this
controller and it is presented to the operating system as a single
storage device. Often have reliability guarantees.</p></li>
<li><p>Partial hardware implementation - Same as the complete hardware
implementation, except parity calculations, and buffering are
delegated to the host CPU and memory. Don’t often have reliability
guarantees.</p></li>
<li><p>Software implementation - The operating system itself manages
several disks and presents to the file-system layer a single
storage device.</p></li>
</ul>
</li>
</ul>
</section>
<section id="raid-0">
<h2>RAID - 0<a class="headerlink" href="#raid-0" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id10">
<img alt="image" src="_images/raid_0.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id10" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="raid-1">
<h2>RAID - 1<a class="headerlink" href="#raid-1" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id11">
<img alt="image" src="_images/raid_1.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id11" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="raid-5">
<h2>RAID - 5<a class="headerlink" href="#raid-5" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id12">
<img alt="image" src="_images/raid_5.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id12" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="raid-5-parity">
<h2>RAID - 5 Parity<a class="headerlink" href="#raid-5-parity" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size_t</span> <span class="n">parityWrite</span><span class="p">(</span>
        <span class="nb">int</span> <span class="n">fd0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fd1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fd2</span><span class="p">,</span>
        <span class="n">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">buf0</span><span class="p">,</span> <span class="n">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">buf1</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">char</span> <span class="n">byte0</span> <span class="o">=</span> <span class="p">((</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">buf0</span><span class="p">)[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">char</span> <span class="n">byte1</span> <span class="o">=</span> <span class="p">((</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">buf1</span><span class="p">)[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">char</span> <span class="n">parity</span> <span class="o">=</span> <span class="n">byte0</span> <span class="o">^</span> <span class="n">byte1</span><span class="p">;</span>
                <span class="n">write</span><span class="p">(</span><span class="n">fd0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">byte0</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">));</span>
                <span class="n">write</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">byte1</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">));</span>
                <span class="n">write</span><span class="p">(</span><span class="n">fd2</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">parity</span><span class="p">,</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">));</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2>RAID - 5 Parity<a class="headerlink" href="#id2" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">size_t</span> <span class="n">parityRead</span><span class="p">(</span><span class="nb">int</span> <span class="n">fd0</span><span class="p">,</span> <span class="nb">int</span> <span class="n">fd1</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">count</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">char</span> <span class="o">*</span><span class="n">buff0</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">count</span><span class="p">);</span>
        <span class="n">char</span> <span class="o">*</span><span class="n">buff1</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">count</span><span class="p">);</span>
        <span class="n">char</span> <span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
        <span class="n">read</span><span class="p">(</span><span class="n">fd0</span><span class="p">,</span> <span class="n">buff0</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>
        <span class="n">read</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="n">buff1</span><span class="p">,</span> <span class="n">count</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="n">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">buff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">buff0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">buff1</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2>RAID - 5 Parity<a class="headerlink" href="#id3" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">main</span><span class="p">(</span><span class="nb">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">int</span> <span class="n">fd0</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;f0&quot;</span><span class="p">,</span> <span class="n">O_CREAT</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="o">|</span><span class="n">O_RDWR</span><span class="p">,</span> <span class="mi">0666</span><span class="p">);</span>
        <span class="nb">int</span> <span class="n">fd1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span> <span class="n">O_CREAT</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="o">|</span><span class="n">O_RDWR</span><span class="p">,</span> <span class="mi">0666</span><span class="p">);</span>
        <span class="nb">int</span> <span class="n">fd2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;f2&quot;</span><span class="p">,</span> <span class="n">O_CREAT</span><span class="o">|</span><span class="n">O_TRUNC</span><span class="o">|</span><span class="n">O_RDWR</span><span class="p">,</span> <span class="mi">0666</span><span class="p">);</span>

        <span class="n">const</span> <span class="n">char</span><span class="o">*</span> <span class="n">msg0</span> <span class="o">=</span> <span class="s2">&quot;hello world</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="n">const</span> <span class="n">char</span><span class="o">*</span> <span class="n">msg1</span> <span class="o">=</span> <span class="s2">&quot;testing 123</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span>

        <span class="n">parityWrite</span><span class="p">(</span><span class="n">fd0</span><span class="p">,</span><span class="n">fd1</span><span class="p">,</span><span class="n">fd2</span><span class="p">,</span><span class="n">msg0</span><span class="p">,</span><span class="n">msg1</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">msg0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>

        <span class="n">close</span><span class="p">(</span><span class="n">fd0</span><span class="p">);</span>
        <span class="n">close</span><span class="p">(</span><span class="n">fd1</span><span class="p">);</span>
        <span class="n">close</span><span class="p">(</span><span class="n">fd2</span><span class="p">);</span>

        <span class="n">unlink</span><span class="p">(</span><span class="s2">&quot;f1&quot;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="id4">
<h2>RAID - 5 Parity<a class="headerlink" href="#id4" title="Permalink to this headline"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="n">fd0</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;f0&quot;</span><span class="p">,</span> <span class="n">O_RDWR</span><span class="p">,</span> <span class="mi">0666</span><span class="p">);</span>
        <span class="n">fd2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;f2&quot;</span><span class="p">,</span> <span class="n">O_RDWR</span><span class="p">,</span> <span class="mi">0666</span><span class="p">);</span>

        <span class="n">size_t</span> <span class="n">msgSize</span> <span class="o">=</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="p">)</span><span class="o">*</span><span class="n">strlen</span><span class="p">(</span><span class="n">msg0</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">char</span> <span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="p">(</span><span class="n">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">msgSize</span><span class="p">);</span>

        <span class="n">parityRead</span><span class="p">(</span><span class="n">fd0</span><span class="p">,</span> <span class="n">fd2</span><span class="p">,</span> <span class="n">buff</span><span class="p">,</span> <span class="n">msgSize</span><span class="p">);</span>

        <span class="n">printf</span><span class="p">(</span><span class="s2">&quot;f1 contents are = </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">buff</span><span class="p">);</span>

        <span class="n">close</span><span class="p">(</span><span class="n">fd0</span><span class="p">);</span>
        <span class="n">close</span><span class="p">(</span><span class="n">fd2</span><span class="p">);</span>

        <span class="n">free</span><span class="p">(</span><span class="n">buff</span><span class="p">);</span>
        <span class="n">unlink</span><span class="p">(</span><span class="s2">&quot;f0&quot;</span><span class="p">);</span>
        <span class="n">unlink</span><span class="p">(</span><span class="s2">&quot;f2&quot;</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="raid-5-parity-and-recovery">
<h2>RAID 5 - Parity and Recovery<a class="headerlink" href="#raid-5-parity-and-recovery" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>In the above example, three files are created, f0, f1, and f2</p></li>
<li><p>Two different messages are written to each of f0 and f1. Parity data
is written to f2.</p></li>
<li><p>Failure scenarios:</p>
<ul>
<li><p>f0 is deleted - f0 can be recovered from f1 and the parity data of
f2</p></li>
<li><p>f1 is deleted - f1 can be recovered from f0 and the parity data of
f2</p></li>
<li><p>f2 is deleted - f2 can be recovered by recalculating the parity
between f0 and f1</p></li>
</ul>
</li>
<li><p>In each case, the loss of one storage medium causes no data loss.</p></li>
</ul>
</section>
<section id="disk-partitioning">
<h2>Disk Partitioning<a class="headerlink" href="#disk-partitioning" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Operating systems divide disks into partitions (or slices).</p></li>
<li><p>Partitions are a useful concept in that they allow an operating
system to divide parts of the disk into different types of disk
formats. Among these will be a filesystem implementation, in some
cases a swap partition, and filesystems not managed by the operating
system (such as in a dual boot configuration).</p></li>
</ul>
</section>
<section id="id5">
<h2>Disk Partitioning<a class="headerlink" href="#id5" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>On the PC, the most common format for partitions is the MBR (master
boot record) scheme. The MBR scheme allows a disk to be divided into
up to four partitions. The offsets and sizes of these partitions are
located in the MBR record at the beginning of the disk.</p></li>
<li><p>To raise the limitation on four partitions, the MBR schema allows for
one partition to be considered an “extended” partition which can be
further subdivided into multiple “logical” partitions.</p></li>
</ul>
</section>
<section id="disk-arms-heads">
<h2>Disk Arms / Heads<a class="headerlink" href="#disk-arms-heads" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>For mechanical disks, there are two moving parts:</p>
<ul>
<li><p>The head - driven by a stepper motor. Moves to the correct track
on the platter</p></li>
<li><p>The disk motor - spins the platters under the head.</p></li>
</ul>
</li>
<li><p>For a sector to be read from or written to a hard disk, the platter
must be rotated to the correct position and the head must be moved to
the right position to perform the operation.</p></li>
<li><p>So for a given operation, there is a concept of a physical distance
the device must ’seek’ to perform the operation.</p></li>
<li><p>The performance of disk operations are governed by:</p>
<ul>
<li><p>The speed of the disk and head motors</p></li>
<li><p>The algorithm that orders one or more possible disk operations.</p></li>
</ul>
</li>
</ul>
</section>
<section id="id6">
<h2>Hard Disk Geometry - CHS<a class="headerlink" href="#id6" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id13">
<img alt="image" src="_images/disk_diagram.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id13" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="characteristics-of-a-good-disk-scheduling-algorithm">
<h2>Characteristics of a Good Disk Scheduling Algorithm<a class="headerlink" href="#characteristics-of-a-good-disk-scheduling-algorithm" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Like a process scheduler, decisions involve avoiding starvation and
addressing both latency and throughput.</p></li>
<li><p>Goals of a good algorithm:</p>
<ul>
<li><p>Should avoid moving the head if another request exists in the same
track.</p></li>
<li><p>Should minimize moving the head overall.</p></li>
<li><p>Should minimize the average distance from the current position of
the head and the next request at any given time.</p></li>
<li><p>When ordering requests, an individual request should not be
delayed for too long.</p></li>
</ul>
</li>
</ul>
</section>
<section id="disk-scheduling-algorithms">
<h2>Disk Scheduling Algorithms<a class="headerlink" href="#disk-scheduling-algorithms" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>FIFO</p></li>
<li><p>Shortest Seek First</p></li>
<li><p>Elevator</p></li>
<li><p>FSCAN</p></li>
</ul>
</section>
<section id="fifo">
<h2>FIFO<a class="headerlink" href="#fifo" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>FIFO is the simplest disk scheduling algorithm</p></li>
<li><p>FIFO simply serves the requests in order as they arrive.</p></li>
<li><p>FIFO is far from optimal. It does not make any attempt to minimize
the seeking of the head.</p></li>
<li><p>FIFO does guarantee fairness. Requests are answered in the order that
they are received.</p></li>
</ul>
</section>
<section id="shortest-seek-first">
<h2>Shortest Seek First<a class="headerlink" href="#shortest-seek-first" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Shortest Seek First scans the request queue for the request that is
nearest the head and serves that request first.</p></li>
<li><p>This algorithm minimizes the total seeking that the head must perform</p></li>
<li><p>This algorithm can allow requests to starve. If new requests keep
coming in that are near the current position of the head at a
sufficient rate, the disk head will never move near enough to other
requests to service them.</p></li>
</ul>
</section>
<section id="id7">
<h2>Shortest Seek First<a class="headerlink" href="#id7" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id14">
<img alt="image" src="_images/shortest_seek_first.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id14" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="elevator-algorithm">
<h2>Elevator Algorithm<a class="headerlink" href="#elevator-algorithm" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>A good way to visualize a disk scheduling algorithm is to think of
how to make the operation of an elevator in a building that has
several floors optimal.</p></li>
<li><p>To guarantee that every floor is visited and no one is kept waiting
forever, the elevator algorithm’s rule is that the elevator should go
all the way to the top floor before reversing direction to go back to
the bottom floor.</p></li>
<li><p>This means that the algorithm has a concept of a direction. Given a
list of requests, the requests that will be served are those that are
in the current track or those that are in the direction of the head’s
movement (in order).</p></li>
<li><p>Once the head reaches the final track, the direction is reversed and
the algorithm is repeated.</p></li>
</ul>
</section>
<section id="id8">
<h2>Elevator Algorithm<a class="headerlink" href="#id8" title="Permalink to this headline"></a></h2>
<blockquote>
<div><figure class="align-center" id="id15">
<img alt="image" src="_images/elevator.png" />
<figcaption>
<p><span class="caption-text">image</span><a class="headerlink" href="#id15" title="Permalink to this image"></a></p>
</figcaption>
</figure>
</div></blockquote>
</section>
<section id="evaluation-of-the-elevator-algorithm">
<h2>Evaluation of the Elevator Algorithm<a class="headerlink" href="#evaluation-of-the-elevator-algorithm" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>Pros:</p>
<ul>
<li><p>Prevents starvation of requests</p></li>
</ul>
</li>
<li><p>Cons:</p>
<ul>
<li><p>Sectors in the middle of the disk are serviced faster on average
because their average distance from the head is the least.</p></li>
</ul>
</li>
<li><p>The elevator algorithm can remove the imbalance by starting at the
innermost track, seeking to the outermost and then returning to the
innermost. This way the direction never changes. Unfortunately, this
particular seek takes more time than others due to the greater
distance.</p></li>
</ul>
</section>
<section id="fscan">
<h2>FSCAN<a class="headerlink" href="#fscan" title="Permalink to this headline"></a></h2>
<ul class="simple">
<li><p>FSCAN works by taking the existing set of requests and putting them
in one queue</p></li>
<li><p>All new requests received while completing work in the first queue
are put into a second queue.</p></li>
<li><p>FSCAN then services the items in the first queue by serving requests
nearest the head to the requests furthest from the head in order</p></li>
<li><p>Once the first queue is empty, items from the second queue are moved
to the first queue and the algorithm repeats</p></li>
<li><p>FSCAN guarantees that there will be no starvation because there will
be at most a fixed set of N items that need to be served before any
given item is served.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="userlandmm.html" class="btn btn-neutral float-left" title="Userland Memory Management" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fs.html" class="btn btn-neutral float-right" title="Implementing Files and Folders" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2020, Operating Systems Faculty at Loyola University Chicago.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>